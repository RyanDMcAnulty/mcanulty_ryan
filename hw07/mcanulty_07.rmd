---
title: "HW 07: Data Importing and Wrangling 1"
author: "Ryan McAnulty"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---

#### Limpets
## Loading tidyverse and reading limpets.csv data
```{r}
library(tidyverse)
library(here)
```

The data is tidy.

## Defining limpets_data and forcing column types
```{r}
limpets_data <- read_csv(here("data", "limpets.csv"), col_types = "ncc")
```

## Setting levels for Site 
```{r}
limpets_data$Site <- factor(limpets_data$Site, levels = c("PBL", "KNRM", "VBG", "WP", "PF", "DP", "SIO", "CTZ1", "CTZ2", "CNMM"), ordered = TRUE)
```

## Box plot of limpets_data Length (mm) vs. Site with Protected status colored
```{r}
ggplot(data = limpets_data) +
  geom_boxplot(mapping = aes(x = Length, y = Site, color = Protected)) +
  labs(x = "Length (mm)")
```
The DP and WP sites have some outliers longer than the rest of the data.  For the most part, the protected sites tend to have larger Limpets.

#### Roseate Terns
## Reading and Naming data terns
```{r}
terns <- read_tsv(here("data", "roseate_terns.txt"))
```

## Reviewing data
```{r}
terns
```

## Tidying data
```{r}
terns_data <- terns %>% 
  pivot_longer(c(AR:JC), names_to="Site",values_to="Population")
```

## Confirming tidying
```{r}
terns_data
```

## Filtering out NAs
```{r}
terns_complete_data <- filter(drop_na(terns_data))
```

## Line graph of Population vs. year of each site
```{r}
ggplot(data = terns_complete_data)+
  geom_line(mapping=aes(x=Population,y=year,color=Site))+
  labs(y="Year")
```
AC, AR, BC, JC obviously increase in population over time.

BR, JR had obvious decreases in population over time.

The line breaks come from haveing no data from that site in that year.

#### Blacklip Abalone
## Chunk 1: Reading abalone data, removing first column, and making a boxplot of each type
```{r}
abalone <- read_csv(here("data", "abalone.csv"))
abalone_data <- select(abalone, -(X1))
ggplot(data = abalone_data) +
  geom_boxplot(mapping = aes(x = Height, y = Type))
```

## Chunk 2: Scatterplot of Height vs. Rings to determine if outliers are old
```{r}
ggplot(data = abalone_data) +
  geom_point(mapping = aes(x = Height, y = Rings, color = Type))
```
No, it does not appear that the two outliers are exceptionally old, they both have <= 10 rings.

## Chunk 3: Filtering out the two outliers as coding errors, Ordering Type from I to M to F.  Replotting to see trends.
```{r}
abalone_data_no_outliers <- filter(abalone_data, Height <= 0.3)
factor(abalone_data_no_outliers$Type, levels = c("I", "M", "F"), ordered = TRUE)
ggplot(data = abalone_data_no_outliers) +
  geom_point(mapping = aes(x = Height, y = Rings, color = Type))
```
For the most part, the Immature ones are the shortest and have fewer rings; they are juveniles.  The males and females seem to be evenly dispersed with no real trends on height or rings bases on sex.

#### Chunk 4: 
```{r}
print(abalone_data_no_outliers(any.abalone_data_no_outliers$Height == 0, "Height"]
is.na <- filter(abalone_data_no_outliers,Height==0)
ggplot(data = abalone_data_no_outliers) +
  geom_point(mapping = aes(x = Height, y = Rings, color = Type))
```

