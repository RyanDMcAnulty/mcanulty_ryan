---
title: "HW11: Data Visualization I (con't)"
author: "Ryan McAnulty"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---

## Loading required libraries
```{r}
library(tidyverse)
library(here)
library(GGally)
library(patchwork)
```

## Importing aegla_crabs.csv data
```{r}
aegla <-                            # Importing and naming aegla_crabs.csv data
  read.csv(here("data", 
                "aegla_crabs.csv"))
aegla_wrangled <- aegla %>%         # Wrangling data
  select(-"Site",                   # Removing columns Site, AT, WT, Crab, Shrimp, Aeglam, AeglaFE, and AeglaFo
         -"AT",
         -"WT",
         -"Crab",
         -"Shrimp",
         -"Aeglam",
         -"AeglaFe",
         -"AeglaFo") %>% 
  drop_na() %>%                     # Dropping remaining NAs
  mutate(row_order = 1:nrow(.))     # Creating arbitrary variable for plotting purposes. Setting number of rows 1 to 55.
aegla_wrangled
```

##  Looking for possible outliers
```{r}
aegla_wrangled %>% ggscatmat(columns = 1:13) # It is tiny in the notebook, but looking at it in the console obvious outliers can be seen. After looking at these and running multiple cleveland plots, I think these are the three possible outlier data points, as displayed by the three plots below.
```

## Displaying three cleveland plots to determine true outliers
```{r}
aegla_wrangled %>%
  ggplot(aes(x = Depth,
             y = row_order)) +
  geom_point() +
  labs(x = "Depth",
       y = "row_order")
aegla_wrangled %>%
  ggplot(aes(x = pH,
             y = row_order)) +
  geom_point() +
  labs(x = "ph",
       y = "row_order")
aegla_wrangled %>%
  ggplot(aes(x = Phos,
             y = row_order)) +
  geom_point() +
  labs(x = "Phos",
       y = "row_order")
```
Three possible outliers are depth being 5, pH being 6.25, and Phos Concentration being 0.88.
I could see all of these three points as outliers, but the pH of 6.25 and Depth of 5 are the weakest ones.  The pH 
is not that low at all compared to the other values.  The depth at 5 is an is high, but it also corresponds to the 
width of the stream being 12.  This slighlty deeper and wider part is certainly possible.  I would ultimately say that the 
Phosphorus concentration of 0.88 from site AG1KN1 is insanely high compared to every other sample and must be due 
to an agricultural contamination.  Looking at original data, it is also only one of two sites where no data from 
specimen counts is available.

